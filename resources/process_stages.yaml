# process_stages.yaml
version: v1
processes:
  - id: "curing_001"
    name: "固化工艺"
    description: "复合材料固化过程"
    
    # 传感器组配置（工艺级别）
    sensor_groups:
      - group_name: "temperature_group"
        description: "温度传感器组"
        sensors:
          - name: "ptc1"
            description: "PTC1温度传感器"
            data_column: "PTC10"  # CSV中的实际列名
          - name: "ptc2" 
            description: "PTC2温度传感器"
            data_column: "PTC11"
          - name: "ptc3"
            description: "PTC3温度传感器" 
            data_column: "PTC23"
          - name: "ptc4"
            description: "PTC4温度传感器"
            data_column: "PTC24"
        aggregation_method: "concat"  # 聚合方式：concat（按行拼接）, mean, max, min, std
      - group_name: "pressure_group"
        description: "压力传感器组"
        sensors:
          - name: "pressure"
            description: "压力传感器"
            data_column: "PRESS"
        aggregation_method: "concat"
    
    # 工艺阶段定义
    stages:
      - id: "heating"
        name: "加热阶段"
        description: "从室温加热到目标温度"
        detection_criteria: "temperature_group < 180 and rate(temperature_group) > 0"
        rules:
          - rule_id: "rule_heating_rate_001"
            parameters:
              max_rate: 2.0 

      - id: "soaking"
        name: "保温阶段"
        description: "在目标温度下保持一段时间"
        detection_criteria: "temperature_group >= 180"
        rules:
          - rule_id: "rule_temperature_stability_001"
            parameters:
              max_std: 3.0
          - rule_id: "rule_pressure_check_001"
            parameters:
              min_pressure: 0.8
              max_pressure: 1.5

      - id: "cooling"
        name: "冷却阶段"
        description: "从目标温度冷却到室温"
        detection_criteria: "temperature_group < 180 and rate(temperature_group) < 0"
        rules:
          - rule_id: "rule_cooling_rate_001"
            parameters:
              max_cooling_rate: -0.5