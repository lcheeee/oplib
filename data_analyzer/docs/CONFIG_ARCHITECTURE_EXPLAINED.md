# é…ç½®æ¶æ„è®¾è®¡è¯´æ˜

## ä¸€ã€ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿâ€”â€”è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ

### èƒŒæ™¯é—®é¢˜

ä» `å›ºåŒ–æ£€éªŒè¦æ±‚_20240828.html` å¯ä»¥çœ‹åˆ°ï¼Œç³»ç»Ÿéœ€è¦æ”¯æŒ**20+ç§ä¸åŒçš„å·¥è‰ºè§„èŒƒ**ï¼š

1. **ä¸åŒç‰ˆæœ¬**ï¼šJç‰ˆã€Dç‰ˆã€Gç‰ˆã€Nç‰ˆã€Cç‰ˆã€Fç‰ˆã€Hç‰ˆ
2. **ä¸åŒææ–™**ï¼šCMS-CP-301åˆ°312ã€CMS-AD-104åˆ°108ç­‰
3. **ä¸åŒå·¥è‰º**ï¼šé€šå¤§æ°”ã€å…¨ç¨‹æŠ½çœŸç©º
4. **ä¸åŒå‚æ•°**ï¼šæ¯ä¸ªè§„èŒƒçš„æ¸©åº¦ã€å‹åŠ›ã€é€Ÿç‡è¦æ±‚éƒ½ä¸åŒ

### æ ¸å¿ƒéœ€æ±‚

```
åŒä¸€ä¸ªåˆ†æç³»ç»Ÿ + ä¸åŒçš„å·¥è‰ºè§„èŒƒ â†’ ä¸åŒçš„æ£€éªŒç»“æœ
```

**é—®é¢˜**ï¼š
- âŒ å¦‚æœæŠŠè§„èŒƒå‚æ•°ç¡¬ç¼–ç åœ¨ä»£ç é‡Œ â†’ æ¯å¢åŠ ä¸€ä¸ªè§„èŒƒå°±è¦æ”¹ä»£ç 
- âŒ å¦‚æœä¸€ä¸ªè§„èŒƒæ”¹åŠ¨ â†’ éœ€è¦ä¿®æ”¹ä»£ç å¹¶é‡æ–°æµ‹è¯•
- âŒ å¦‚æœè§„èŒƒæ•°é‡å¾ˆå¤šï¼ˆ20+ï¼‰ â†’ ä»£ç ä¼šå˜å¾—è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… æŠŠè§„èŒƒå‚æ•°ä»ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œæ”¾åœ¨é…ç½®æ–‡ä»¶ä¸­
- âœ… è¿è¡Œæ—¶æ ¹æ®è¯·æ±‚çš„è§„èŒƒIDåŠ è½½å¯¹åº”é…ç½®
- âœ… è§„èŒƒå’Œä»£ç è§£è€¦ï¼Œå¯ä»¥ç‹¬ç«‹ç»´æŠ¤

---

## äºŒã€é…ç½®æ–‡ä»¶çš„èŒè´£åˆ†å·¥

### ğŸ“‹ é…ç½®æ–‡ä»¶åˆ†å±‚æ¶æ„

```
å¯åŠ¨é…ç½®å±‚ (startup_config.yaml)
    â†“
å…±äº«é…ç½®å±‚ (shared/*.yaml)
    â†“
å·¥ä½œæµé…ç½®å±‚ (workflow_config.yaml)
    â†“
è§„èŒƒç´¢å¼•å±‚ (specifications/index.yaml)
    â†“
è§„èŒƒé…ç½®å±‚ (specifications/{spec_id}/*.yaml)
    â†“
æ¨¡æ¿å±‚ (templates/*.yaml) â€”â€”â€”â€” ç”¨äºç”Ÿæˆè§„èŒƒé…ç½®
```

### å±‚çº§è¯¦è§£

#### 1ï¸âƒ£ å¯åŠ¨é…ç½®å±‚ï¼šç³»ç»Ÿå¯åŠ¨å…¥å£

**æ–‡ä»¶**ï¼š`config/startup_config.yaml`

**ä½œç”¨**ï¼š
- å®šä¹‰ç³»ç»Ÿå¯åŠ¨æ—¶éœ€è¦åŠ è½½å“ªäº›é…ç½®æ–‡ä»¶
- è®¾ç½®ç³»ç»Ÿå‚æ•°ï¼ˆç«¯å£ã€æ—¥å¿—çº§åˆ«ç­‰ï¼‰
- è¶…æ—¶è®¾ç½®

**å†…å®¹ç¤ºä¾‹**ï¼š
```yaml
config_files:
  workflow_config: "config/workflow_config.yaml"  # â† å·¥ä½œæµå®šä¹‰
  sensor_groups: "config/shared/sensor_groups.yaml"  # â† ä¼ æ„Ÿå™¨åˆ†ç»„
  calculations: "config/shared/calculations.yaml"   # â† è®¡ç®—é¡¹
  process_stages: "config/shared/process_stages_by_time.yaml"  # â† å…¨å±€é˜¶æ®µ

startup:
  host: "0.0.0.0"
  port: 8000
  debug: true
```

**ä½¿ç”¨æ—¶æœº**ï¼šç³»ç»Ÿå¯åŠ¨æ—¶ï¼ˆ`main.py` å¯åŠ¨æ—¶ï¼‰

**å¿…è¦ç¨‹åº¦**ï¼šâœ… **å¿…é¡»** - ç³»ç»Ÿå¯åŠ¨ä¾èµ–æ­¤é…ç½®

---

#### 2ï¸âƒ£ å…±äº«é…ç½®å±‚ï¼šå®šä¹‰é€šç”¨æ¦‚å¿µ

**æ–‡ä»¶**ï¼š
- `shared/sensor_groups.yaml` - ä¼ æ„Ÿå™¨åˆ†ç»„å®šä¹‰
- `shared/calculations.yaml` - è®¡ç®—é¡¹å®šä¹‰
- `shared/process_stages_by_time.yaml` - å…¨å±€é˜¶æ®µæ¨¡æ¿

##### 2.1 ä¼ æ„Ÿå™¨åˆ†ç»„ (`sensor_groups.yaml`)

**ä½œç”¨**ï¼šå®šä¹‰æ•°æ®çš„ç‰©ç†æ¥æº

```yaml
sensor_groups:
  VACUUM_PRESS:
    description: "è¢‹å†…å‹ä¼ æ„Ÿå™¨ï¼ˆçœŸç©ºå‹åŠ›ï¼‰"
    columns: "VPRB1"
    unit: "kPa"
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ•°æ®è¯»å–æ—¶è¯†åˆ«å“ªä¸€åˆ—æ˜¯ä»€ä¹ˆä¼ æ„Ÿå™¨
- ä¼ æ„Ÿå™¨åˆ†ç»„æ—¶æ ¹æ®åç§°æ˜ å°„åˆ°åˆ—å

**å¿…è¦ç¨‹åº¦**ï¼šâœ… **å¿…é¡»** - ç³»ç»Ÿéœ€è¦çŸ¥é“æ•°æ®åˆ—çš„å«ä¹‰

**é…ç½®æ—¶æœº**ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åŠ è½½

---

##### 2.2 è®¡ç®—é¡¹é…ç½® (`calculations.yaml`)

**ä½œç”¨**ï¼šå®šä¹‰éœ€è¦è®¡ç®—å“ªäº›æ´¾ç”ŸæŒ‡æ ‡

```yaml
calculations:
  - id: "heating_rate"
    description: "æ¸©åº¦å˜åŒ–é€Ÿç‡"
    formula: "rate(thermocouples, step=1, axis=0, timestamps=timestamps)"
    sensors: ["thermocouples", "timestamps"]
    unit: "â„ƒ/min"
    type: "calculated"
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- è§„åˆ™å¼•æ“éœ€è¦è®¡ç®—"å‡æ¸©é€Ÿç‡"ã€"ä¿æ¸©æ—¶é—´"ç­‰æ´¾ç”ŸæŒ‡æ ‡
- è¿™äº›è®¡ç®—è¡¨è¾¾å¼ç»Ÿä¸€å®šä¹‰åœ¨è¿™é‡Œ

**å¿…è¦ç¨‹åº¦**ï¼šâœ… **å¿…é¡»** - è§„åˆ™å¼•æ“ä¾èµ–è¿™äº›è®¡ç®—é¡¹

**é…ç½®æ—¶æœº**ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åŠ è½½

**é…ç½®è¯´æ˜**ï¼š
```yaml
- id: "heating_rate"        # è®¡ç®—é¡¹IDï¼Œåœ¨è§„åˆ™ä¸­å¼•ç”¨
  description: "æ¸©åº¦å˜åŒ–é€Ÿç‡"
  formula: "rate(...)"      # ASTè¡¨è¾¾å¼ï¼Œå®šä¹‰å¦‚ä½•è®¡ç®—
  sensors: ["thermocouples", "timestamps"]  # ä¾èµ–çš„ä¼ æ„Ÿå™¨
  unit: "â„ƒ/min"
```

---

##### 2.3 å…¨å±€é˜¶æ®µé…ç½® (`process_stages_by_time.yaml`)

**ä½œç”¨**ï¼šå®šä¹‰æ—¶é—´ç»´åº¦çš„å·¥è‰ºé˜¶æ®µ

```yaml
stages:
  - id: "heating_phase"
    description: "å‡æ¸©é˜¶æ®µ"
    time_range:
      start: "2022-11-03T13:30:21"
      end: "2022-11-03T14:30:21"
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ•°æ®åˆ†å—æ—¶æŒ‰æ—¶é—´èŒƒå›´åˆ’åˆ†é˜¶æ®µ
- è¯†åˆ«æ•°æ®å±äºå“ªä¸ªå·¥è‰ºé˜¶æ®µ

**å¿…è¦ç¨‹åº¦**ï¼šâš ï¸ **éƒ¨åˆ†ä½¿ç”¨** - åŒ…å«ç¡¬ç¼–ç çš„ç¤ºä¾‹æ•°æ®ï¼Œå®é™…åº”æŒ‰è§„èŒƒåŠ è½½

**é—®é¢˜**ï¼šè¿™ä¸ªæ–‡ä»¶åŒ…å«çš„æ˜¯**ç¤ºä¾‹æ•°æ®**ï¼Œä¸æ˜¯é€šç”¨æ¨¡æ¿ã€‚åº”è¯¥æŒ‰è§„èŒƒåŠ è½½å„è‡ªçš„ stages.yaml

---

#### 3ï¸âƒ£ å·¥ä½œæµé…ç½®å±‚ï¼šå®šä¹‰åˆ†ææµç¨‹

**æ–‡ä»¶**ï¼š`config/workflow_config.yaml`

**ä½œç”¨**ï¼šå®šä¹‰å·¥ä½œæµçš„ä»»åŠ¡å’Œä¾èµ–å…³ç³»

```yaml
workflows:
  curing_analysis:
    workflow:
      - layer: "data_source"
        tasks:
          - id: "load_primary_data"
            implementation: "csv"
            algorithm: "local_csv_reader"
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- å·¥ä½œæµæ‰§è¡Œå™¨æ ¹æ®æ­¤é…ç½®æ„å»ºæ‰§è¡Œè®¡åˆ’
- å®šä¹‰æ•°æ®å¤„ç†çš„å„ä¸ªæ­¥éª¤

**å¿…è¦ç¨‹åº¦**ï¼šâœ… **å¿…é¡»** - ç³»ç»Ÿéœ€è¦çŸ¥é“å¦‚ä½•æ‰§è¡Œå·¥ä½œæµ

**é…ç½®æ—¶æœº**ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åŠ è½½

---

#### 4ï¸âƒ£ è§„èŒƒç´¢å¼•å±‚ï¼šç®¡ç†æ‰€æœ‰è§„èŒƒ

**æ–‡ä»¶**ï¼š`config/specifications/index.yaml`

**ä½œç”¨**ï¼šæ˜ å°„è§„èŒƒIDåˆ°é…ç½®ç›®å½•

```yaml
specifications:
  cps7020-n-308-vacuum:
    specification_id: "cps7020-n-308-vacuum"
    specification_name: "CPS7020 Nç‰ˆï¼ˆCMS-CP-308ææ–™é€šå¤§æ°”ï¼‰"
    materials:
      - code: "CMS-CP-308"
    config_dir: "specifications/cps7020-n-308-vacuum"  # â† æŒ‡å‘é…ç½®ç›®å½•
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œæ ¹æ® `specification_id` æŸ¥æ‰¾é…ç½®ç›®å½•
- æ”¯æŒ"ä¸€ä¸ªææ–™å¯¹åº”å¤šä¸ªè§„èŒƒ"

**å¿…è¦ç¨‹åº¦**ï¼šâœ… **å¿…é¡»** - è¿™æ˜¯è§„èŒƒå·é©±åŠ¨æ¶æ„çš„ç´¢å¼•

**é…ç½®æ—¶æœº**ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åŠ è½½

**é…ç½®è¯´æ˜**ï¼š
```yaml
specifications:
  {è§„èŒƒID}:           # ä¾‹å¦‚ï¼šcps7020-n-308-vacuum
    specification_id: "cps7020-n-308-vacuum"
    config_dir: "specifications/cps7020-n-308-vacuum"  # å…³é”®ï¼šæŒ‡å‘é…ç½®ç›®å½•
    materials:         # è¯¥è§„èŒƒé€‚ç”¨çš„ææ–™
      - code: "CMS-CP-308"
        primary: true
```

---

#### 5ï¸âƒ£ è§„èŒƒé…ç½®å±‚ï¼šå®šä¹‰å…·ä½“è§„èŒƒ

**ç›®å½•**ï¼š`config/specifications/{spec_id}/`

**æ–‡ä»¶ç»“æ„**ï¼š
```
specifications/cps7020-n-308-vacuum/
â”œâ”€â”€ specification.yaml  # å·¥è‰ºå‚æ•°å®šä¹‰
â”œâ”€â”€ rules.yaml          # è§„åˆ™å®šä¹‰
â””â”€â”€ stages.yaml         # é˜¶æ®µå®šä¹‰
```

##### 5.1 specification.yaml - å·¥è‰ºå‚æ•°

**ä½œç”¨**ï¼šå®šä¹‰å·¥è‰ºçš„å·¥è‰ºå‚æ•°ï¼ˆä¸æ˜¯è§„åˆ™ï¼‰

```yaml
process_params:
  initial_bag_pressure: 
    min: -74
    unit: "kPa"
    description: "é€šå¤§æ°”å‰é˜¶æ®µè¢‹å†…å‹åº”â‰¥-74kPa"
    
heating_rates:
  - stage: 1
    temp_range: [55, 150]
    rate_range: [0.5, 3.0]
    
soaking:
  temp_range: [174, 186]
  duration:
    min: 120
    max: 300
```

**å¿…è¦ç¨‹åº¦**ï¼šâš ï¸ **è®¾è®¡å¿…è¦ä½†æœªå®Œå…¨ä½¿ç”¨** - å®šä¹‰äº†å·¥è‰ºå‚æ•°ï¼Œä½†ç³»ç»Ÿä¸­ä¸»è¦ç”¨äºæ–‡æ¡£

**é…ç½®æ—¶æœº**ï¼šæŒ‰éœ€åŠ è½½ï¼ˆå½“è¯·æ±‚æŒ‡å®šè¯¥è§„èŒƒæ—¶ï¼‰

---

##### 5.2 rules.yaml - è§„åˆ™å®šä¹‰

**ä½œç”¨**ï¼šå®šä¹‰è¯¥è§„èŒƒçš„æ£€éªŒè§„åˆ™

```yaml
rules:
  - id: "bag_pressure_check_1"
    template: "initial_bag_pressure"  # â† å¼•ç”¨æ¨¡æ¿
    description: "é€šå¤§æ°”å‰é˜¶æ®µè¢‹å†…å‹æ£€æŸ¥ã€‚è¢‹å†…å‹åº”â‰¥-74kPa"
    parameters:
      calculation_id: "bag_pressure"
      threshold: -74
    stage: "pre_ventilation"
    severity: "major"
```

**å¿…è¦ç¨‹åº¦**ï¼šâœ… **å¿…é¡»** - è§„åˆ™å¼•æ“æ‰§è¡Œè¿™äº›è§„åˆ™

**é…ç½®æ—¶æœº**ï¼šæŒ‰éœ€åŠ è½½ï¼ˆå½“è¯·æ±‚æŒ‡å®šè¯¥è§„èŒƒæ—¶ï¼‰

**é…ç½®è¯´æ˜**ï¼š
```yaml
- id: "rule_001"          # è§„åˆ™å”¯ä¸€ID
  template: "pressure_template"  # ä½¿ç”¨çš„æ¨¡æ¿ï¼ˆå¯é€‰ï¼‰
  description: "è§„åˆ™æè¿°"
  parameters:             # è§„åˆ™å‚æ•°
    calculation_id: "bag_pressure"  # ä½¿ç”¨çš„è®¡ç®—é¡¹
    threshold: -74         # é˜ˆå€¼
  stage: "pre_ventilation" # é€‚ç”¨çš„é˜¶æ®µ
  severity: "major"        # ä¸¥é‡ç¨‹åº¦
```

---

##### 5.3 stages.yaml - é˜¶æ®µå®šä¹‰

**ä½œç”¨**ï¼šå®šä¹‰è¯¥è§„èŒƒçš„å·¥è‰ºé˜¶æ®µ

```yaml
stages:
  - id: "pre_ventilation"
    name: "é€šå¤§æ°”å‰é˜¶æ®µ"
    description: "ä¿æ¸©ç»“æŸåçš„è¢‹å†…å‹æ£€æŸ¥é˜¶æ®µ"
    rules: 
      - "bag_pressure_check_1"
```

**å¿…è¦ç¨‹åº¦**ï¼šâš ï¸ **éƒ¨åˆ†ä½¿ç”¨** - å®šä¹‰äº†é˜¶æ®µï¼Œä½†å®é™…é˜¶æ®µè¯†åˆ«åŸºäºæ—¶é—´èŒƒå›´

**é…ç½®æ—¶æœº**ï¼šæŒ‰éœ€åŠ è½½

**é…ç½®è¯´æ˜**ï¼š
```yaml
stages:
  - id: "stage_001"       # é˜¶æ®µID
    name: "å‡æ¸©é˜¶æ®µ"
    rules:               # è¯¥é˜¶æ®µçš„è§„åˆ™åˆ—è¡¨
      - "rule_001"
      - "rule_002"
```

---

#### 6ï¸âƒ£ æ¨¡æ¿å±‚ï¼šç”¨äºç”Ÿæˆè§„èŒƒé…ç½®

**ç›®å½•**ï¼š`config/templates/`

**æ–‡ä»¶**ï¼š
- `pressure_rules.yaml` - å‹åŠ›è§„åˆ™æ¨¡æ¿
- `temperature_rules.yaml` - æ¸©åº¦è§„åˆ™æ¨¡æ¿
- `rate_rules.yaml` - é€Ÿç‡è§„åˆ™æ¨¡æ¿
- `thermocouple_rules.yaml` - çƒ­ç”µå¶è§„åˆ™æ¨¡æ¿

**ä½œç”¨**ï¼šå®šä¹‰è§„åˆ™æ¨¡æ¿ï¼Œç”¨äºç”Ÿæˆè§„èŒƒé…ç½®

```yaml
# templates/pressure_rules.yaml
templates:
  initial_bag_pressure:
    pattern: "lower_bound_check"
    description_template: "é€šå¤§æ°”å‰é˜¶æ®µè¢‹å†…å‹æ£€æŸ¥ã€‚è¢‹å†…å‹åº”â‰¥{{threshold}}kPa"
    aggregate: "first"
    severity: "major"
```

**è®¾è®¡æ„å›¾**ï¼š
- ä»å›ºåŒ–æ£€éªŒè¦æ±‚ç”Ÿæˆè§„èŒƒé…ç½®æ—¶ï¼Œä½¿ç”¨æ¨¡æ¿ç»Ÿä¸€è§„åˆ™ç»“æ„
- é¿å…é‡å¤å®šä¹‰ç›¸ä¼¼çš„è§„åˆ™

**å¿…è¦ç¨‹åº¦**ï¼šâŒ **å½“å‰æœªå®ç°** - æ¨¡æ¿ç³»ç»Ÿè¿˜æœªå®Œå…¨å®ç°

**åŸæœ¬è®¡åˆ’çš„ä½¿ç”¨æµç¨‹**ï¼š
```
å›ºåŒ–æ£€éªŒè¦æ±‚ï¼ˆExcelï¼‰
    â†“ ä½¿ç”¨ tools/config_generator/
    â†“ æ ¹æ®æ¨¡æ¿ç”Ÿæˆ
specifications/{spec_id}/rules.yaml
    â†“ è¿è¡Œæ—¶åŠ è½½
è§„åˆ™å¼•æ“æ‰§è¡Œ
```

---

## ä¸‰ã€é…ç½®æ–‡ä»¶ä½¿ç”¨æµç¨‹

### ç³»ç»Ÿå¯åŠ¨æ—¶

```
1. åŠ è½½ startup_config.yaml
   â””â”€ çŸ¥é“è¦åŠ è½½å“ªäº›é…ç½®æ–‡ä»¶
   
2. åŠ è½½å…±äº«é…ç½®
   â”œâ”€ sensor_groups.yaml
   â”œâ”€ calculations.yaml
   â””â”€ process_stages_by_time.yaml
   
3. åŠ è½½ workflow_config.yaml
   â””â”€ æ„å»ºå·¥ä½œæµå®šä¹‰
   
4. åŠ è½½ specifications/index.yaml
   â””â”€ å»ºç«‹è§„èŒƒç´¢å¼•ï¼ˆä¸åŠ è½½å…·ä½“è§„èŒƒï¼‰
```

### æ”¶åˆ°è¯·æ±‚æ—¶

```
1. ç”¨æˆ·è¯·æ±‚
   {
     "specification_id": "cps7020-n-308-vacuum",
     "file_path": "data.csv"
   }
   
2. ç³»ç»ŸæŸ¥æ‰¾è§„èŒƒ
   index.yaml â†’ specifications/cps7020-n-308-vacuum/
   
3. åŠ è½½è§„èŒƒé…ç½®
   â”œâ”€ specification.yaml (å·¥è‰ºå‚æ•°)
   â”œâ”€ rules.yaml (è§„åˆ™å®šä¹‰)
   â””â”€ stages.yaml (é˜¶æ®µå®šä¹‰)
   
4. æ„å»ºæ‰§è¡Œè®¡åˆ’
   æ ¹æ® rules.yaml å’Œ stages.yaml ç”Ÿæˆè®¡åˆ’
   
5. æ‰§è¡Œè§„åˆ™
   ä½¿ç”¨è§„åˆ™å¼•æ“æ‰§è¡Œè®¡åˆ’
```

---

## å››ã€æ¯ä¸ªé…ç½®æ–‡ä»¶æ˜¯å¦åˆç†ã€å¿…è¦ï¼Ÿ

### âœ… å¿…è¦çš„é…ç½®

| é…ç½®æ–‡ä»¶ | ä½œç”¨ | æ˜¯å¦å¿…è¦ | çŠ¶æ€ |
|---------|------|---------|------|
| `startup_config.yaml` | å¯åŠ¨é…ç½®æ¸…å• | âœ… å¿…é¡» | æ­£å¸¸ |
| `sensor_groups.yaml` | ä¼ æ„Ÿå™¨åˆ†ç»„ | âœ… å¿…é¡» | æ­£å¸¸ |
| `calculations.yaml` | è®¡ç®—é¡¹å®šä¹‰ | âœ… å¿…é¡» | æ­£å¸¸ |
| `workflow_config.yaml` | å·¥ä½œæµå®šä¹‰ | âœ… å¿…é¡» | æ­£å¸¸ |
| `specifications/index.yaml` | è§„èŒƒç´¢å¼• | âœ… å¿…é¡» | æ­£å¸¸ |
| `specifications/*/specification.yaml` | å·¥è‰ºå‚æ•°ï¼ˆæ–‡æ¡£ï¼‰ | âš ï¸ éƒ¨åˆ† | æœªå®Œå…¨ä½¿ç”¨ |
| `specifications/*/rules.yaml` | è§„åˆ™å®šä¹‰ | âœ… å¿…é¡» | æ­£å¸¸ |
| `specifications/*/stages.yaml` | é˜¶æ®µå®šä¹‰ | âš ï¸ éƒ¨åˆ† | æœªå®Œå…¨ä½¿ç”¨ |

### âš ï¸ æœ‰é—®é¢˜çš„é…ç½®

| é…ç½®æ–‡ä»¶ | é—®é¢˜ | å»ºè®® |
|---------|------|------|
| `process_stages_by_time.yaml` | åŒ…å«ç¡¬ç¼–ç ç¤ºä¾‹æ•°æ® | æ”¹ä¸ºæŒ‰è§„èŒƒåŠ è½½å„è‡ªçš„stages.yaml |
| `templates/*.yaml` | æ¨¡æ¿ç³»ç»Ÿæœªå®Œå…¨å®ç° | è¦ä¹ˆå®ç°ï¼Œè¦ä¹ˆåˆ é™¤ |
| `specifications/*/specification.yaml` | å®šä¹‰äº†ä½†æœªå®Œå…¨ä½¿ç”¨ | æ˜ç¡®ç”¨é€”æˆ–åˆ é™¤ |

---

## äº”ã€å¦‚ä½•ä½¿ç”¨è¿™äº›é…ç½®æ–‡ä»¶ï¼Ÿ

### æ·»åŠ æ–°è§„èŒƒé…ç½®

1. **åœ¨è§„èŒƒç´¢å¼•ä¸­æ³¨å†Œ**
   ```yaml
   # config/specifications/index.yaml
   specifications:
     my-new-spec:
       specification_id: "my-new-spec"
       config_dir: "specifications/my-new-spec"
       materials:
         - code: "CMS-XX-999"
   ```

2. **åˆ›å»ºè§„èŒƒç›®å½•**
   ```bash
   mkdir -p config/specifications/my-new-spec
   ```

3. **åˆ›å»ºé…ç½®æ–‡ä»¶**
   ```bash
   # specification.yaml - å·¥è‰ºå‚æ•°
   # rules.yaml - è§„åˆ™å®šä¹‰
   # stages.yaml - é˜¶æ®µå®šä¹‰
   ```

4. **é…ç½® rules.yaml**
   ```yaml
   rules:
     - id: "my_rule_001"
       description: "æˆ‘çš„è§„åˆ™"
       parameters:
         calculation_id: "bag_pressure"
         threshold: -80
       stage: "heating_phase"
       severity: "major"
   ```

### ä½¿ç”¨é…ç½®ç”Ÿæˆå·¥å…·

```bash
# ä»Excelç”Ÿæˆé…ç½®ï¼ˆå¦‚æœå®ç°æ¨¡æ¿ç³»ç»Ÿï¼‰
python tools/config_generator/batch_generator.py \
  --excel å›ºåŒ–æ£€éªŒè¦æ±‚_20240828.xlsx \
  --output config/specifications/
```

---

## å…­ã€æ€»ç»“

### é…ç½®æ–‡ä»¶è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³

1. **åˆ†å±‚è®¾è®¡**ï¼šå¯åŠ¨â†’å…±äº«â†’å·¥ä½œæµâ†’è§„èŒƒâ†’æ¨¡æ¿
2. **è§„èŒƒé©±åŠ¨**ï¼šä»¥è§„èŒƒä¸ºå•ä½ç»„ç»‡é…ç½®ï¼Œæ˜“æ‰©å±•
3. **æŒ‰éœ€åŠ è½½**ï¼šå¯åŠ¨æ—¶ä¸åŠ è½½æ‰€æœ‰è§„èŒƒï¼Œè¯·æ±‚æ—¶å†åŠ è½½
4. **é…ç½®å³æ•°æ®**ï¼šè§„èŒƒå‚æ•°ä¸ä»£ç åˆ†ç¦»ï¼Œå¯ç‹¬ç«‹ç»´æŠ¤

### å½“å‰é…ç½®æ–‡ä»¶çš„åˆç†æ€§

- âœ… **æ ¸å¿ƒé…ç½®**ï¼ˆå¯åŠ¨ã€å…±äº«ã€ç´¢å¼•ã€è§„åˆ™ï¼‰ï¼šè®¾è®¡åˆç†ï¼Œå®Œå…¨å¿…è¦
- âš ï¸ **éƒ¨åˆ†é…ç½®**ï¼ˆstages.yamlã€specification.yamlï¼‰ï¼šè®¾è®¡åˆç†ä½†æœªå®Œå…¨å®ç°
- âŒ **æ¨¡æ¿é…ç½®**ï¼šè®¾è®¡åˆç†ä½†æœªå®Œå…¨å®ç°ï¼Œå»ºè®®è¦ä¹ˆå®ç°è¦ä¹ˆåˆ é™¤

### å¦‚ä½•æ­£ç¡®ä½¿ç”¨

1. **ç³»ç»Ÿè¿è¡Œæ—¶**ï¼šä¸è¦æ‰‹åŠ¨åŠ è½½ templates/ï¼Œå®ƒç”±å·¥å…·ä½¿ç”¨
2. **æ·»åŠ æ–°è§„èŒƒ**ï¼šåœ¨ specifications/index.yaml æ³¨å†Œï¼Œåˆ›å»ºå¯¹åº”çš„é…ç½®ç›®å½•
3. **é…ç½®è§„åˆ™**ï¼šåœ¨ specifications/{spec_id}/rules.yaml ä¸­å®šä¹‰
4. **é…ç½®é˜¶æ®µ**ï¼šåœ¨ specifications/{spec_id}/stages.yaml ä¸­å®šä¹‰

